Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.1
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 19:59:50.097000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:00:05.138000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:00:07.533000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:00:08.411000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:00:09.427000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:00:10.304000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:00:11.147000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:00:12.003000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:00:13.162000 1335 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:03<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [11:20<00:00,  4.41it/s, val_loss=3.5323]    
step:125/3000 val_loss:4.8558 train_time:20254ms step_avg:176.12ms
step:250/3000 val_loss:4.3496 train_time:42610ms step_avg:177.54ms
step:375/3000 val_loss:4.1699 train_time:64619ms step_avg:177.04ms
step:500/3000 val_loss:4.0647 train_time:86936ms step_avg:177.42ms
step:625/3000 val_loss:3.9900 train_time:109247ms step_avg:177.64ms
step:750/3000 val_loss:3.9394 train_time:131311ms step_avg:177.45ms
step:875/3000 val_loss:3.8955 train_time:153637ms step_avg:177.62ms
step:1000/3000 val_loss:3.8568 train_time:175951ms step_avg:177.73ms
step:1125/3000 val_loss:3.8301 train_time:198028ms step_avg:177.60ms
step:1250/3000 val_loss:3.8018 train_time:220358ms step_avg:177.71ms
step:1375/3000 val_loss:3.7823 train_time:242683ms step_avg:177.79ms
step:1500/3000 val_loss:3.7581 train_time:264742ms step_avg:177.68ms
step:1625/3000 val_loss:3.7441 train_time:287135ms step_avg:177.79ms
step:1750/3000 val_loss:3.7254 train_time:309531ms step_avg:177.89ms
step:1875/3000 val_loss:3.7094 train_time:331590ms step_avg:177.80ms
step:2000/3000 val_loss:3.6965 train_time:353991ms step_avg:177.89ms
step:2125/3000 val_loss:3.6853 train_time:376376ms step_avg:177.96ms
step:2250/3000 val_loss:3.6556 train_time:398418ms step_avg:177.87ms
step:2375/3000 val_loss:3.6315 train_time:420785ms step_avg:177.92ms
step:2500/3000 val_loss:3.6068 train_time:443156ms step_avg:177.97ms
step:2625/3000 val_loss:3.5819 train_time:465212ms step_avg:177.90ms
step:2750/3000 val_loss:3.5614 train_time:487576ms step_avg:177.95ms
step:2875/3000 val_loss:3.5433 train_time:509945ms step_avg:177.99ms
step:3000/3000 val_loss:3.5323 train_time:532022ms step_avg:177.93ms
Peak memory consumption: 33433 MiB
