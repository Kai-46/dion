Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.2
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 18:16:53.444000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:17:07.227000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:17:09.865000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:17:10.767000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:17:11.824000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:17:12.722000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:17:13.579000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:17:14.463000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:17:15.691000 1437 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:4ms step_avg:nanms
Training:   0%|          | 0/3000 [01:03<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [12:50<00:00,  3.89it/s, val_loss=3.3543]    
step:125/3000 val_loss:4.6910 train_time:23657ms step_avg:205.72ms
step:250/3000 val_loss:4.2057 train_time:49699ms step_avg:207.08ms
step:375/3000 val_loss:4.0231 train_time:75443ms step_avg:206.69ms
step:500/3000 val_loss:3.9060 train_time:101480ms step_avg:207.10ms
step:625/3000 val_loss:3.8287 train_time:127526ms step_avg:207.36ms
step:750/3000 val_loss:3.7734 train_time:153287ms step_avg:207.14ms
step:875/3000 val_loss:3.7262 train_time:179341ms step_avg:207.33ms
step:1000/3000 val_loss:3.6856 train_time:205372ms step_avg:207.45ms
step:1125/3000 val_loss:3.6561 train_time:231092ms step_avg:207.26ms
step:1250/3000 val_loss:3.6265 train_time:257132ms step_avg:207.36ms
step:1375/3000 val_loss:3.6066 train_time:283172ms step_avg:207.45ms
step:1500/3000 val_loss:3.5854 train_time:308940ms step_avg:207.34ms
step:1625/3000 val_loss:3.5677 train_time:334985ms step_avg:207.42ms
step:1750/3000 val_loss:3.5471 train_time:361032ms step_avg:207.49ms
step:1875/3000 val_loss:3.5316 train_time:386743ms step_avg:207.37ms
step:2000/3000 val_loss:3.5173 train_time:412790ms step_avg:207.43ms
step:2125/3000 val_loss:3.5032 train_time:438797ms step_avg:207.47ms
step:2250/3000 val_loss:3.4766 train_time:464530ms step_avg:207.38ms
step:2375/3000 val_loss:3.4510 train_time:490561ms step_avg:207.43ms
step:2500/3000 val_loss:3.4272 train_time:516633ms step_avg:207.48ms
step:2625/3000 val_loss:3.4024 train_time:542349ms step_avg:207.40ms
step:2750/3000 val_loss:3.3815 train_time:568405ms step_avg:207.45ms
step:2875/3000 val_loss:3.3644 train_time:594464ms step_avg:207.49ms
step:3000/3000 val_loss:3.3543 train_time:620218ms step_avg:207.43ms
Peak memory consumption: 33457 MiB
