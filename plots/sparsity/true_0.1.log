Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.1
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 19:23:33.924000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:23:43.104000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:23:45.549000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:23:46.440000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:23:47.514000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:23:48.402000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:23:49.281000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:23:50.190000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:23:51.419000 1392 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:02<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [11:20<00:00,  4.41it/s, val_loss=3.3968]    
step:125/3000 val_loss:4.8859 train_time:20295ms step_avg:176.48ms
step:250/3000 val_loss:4.3562 train_time:42649ms step_avg:177.70ms
step:375/3000 val_loss:4.1398 train_time:64719ms step_avg:177.31ms
step:500/3000 val_loss:4.0071 train_time:87069ms step_avg:177.69ms
step:625/3000 val_loss:3.9180 train_time:109408ms step_avg:177.90ms
step:750/3000 val_loss:3.8549 train_time:131485ms step_avg:177.68ms
step:875/3000 val_loss:3.8039 train_time:153829ms step_avg:177.84ms
step:1000/3000 val_loss:3.7547 train_time:176167ms step_avg:177.95ms
step:1125/3000 val_loss:3.7235 train_time:198259ms step_avg:177.81ms
step:1250/3000 val_loss:3.6904 train_time:220619ms step_avg:177.92ms
step:1375/3000 val_loss:3.6654 train_time:242974ms step_avg:178.00ms
step:1500/3000 val_loss:3.6410 train_time:265056ms step_avg:177.89ms
step:1625/3000 val_loss:3.6189 train_time:287400ms step_avg:177.96ms
step:1750/3000 val_loss:3.5971 train_time:309748ms step_avg:178.02ms
step:1875/3000 val_loss:3.5779 train_time:331838ms step_avg:177.93ms
step:2000/3000 val_loss:3.5635 train_time:354178ms step_avg:177.98ms
step:2125/3000 val_loss:3.5475 train_time:376548ms step_avg:178.04ms
step:2250/3000 val_loss:3.5189 train_time:398642ms step_avg:177.97ms
step:2375/3000 val_loss:3.4942 train_time:420995ms step_avg:178.01ms
step:2500/3000 val_loss:3.4690 train_time:443364ms step_avg:178.06ms
step:2625/3000 val_loss:3.4436 train_time:465461ms step_avg:178.00ms
step:2750/3000 val_loss:3.4236 train_time:487826ms step_avg:178.04ms
step:2875/3000 val_loss:3.4064 train_time:510208ms step_avg:178.08ms
step:3000/3000 val_loss:3.3968 train_time:532316ms step_avg:178.03ms
Peak memory consumption: 33433 MiB
