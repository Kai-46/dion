Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.1
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 20:27:07.237000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:27:16.571000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:27:18.968000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:27:19.871000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:27:20.915000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:27:21.800000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:27:22.709000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:27:23.607000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:27:24.813000 1252 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:04<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [11:24<00:00,  4.39it/s, val_loss=3.3999]    
step:125/3000 val_loss:4.8492 train_time:20288ms step_avg:176.42ms
step:250/3000 val_loss:4.3354 train_time:42657ms step_avg:177.74ms
step:375/3000 val_loss:4.1298 train_time:64742ms step_avg:177.38ms
step:500/3000 val_loss:4.0032 train_time:87132ms step_avg:177.82ms
step:625/3000 val_loss:3.9176 train_time:109514ms step_avg:178.07ms
step:750/3000 val_loss:3.8534 train_time:131608ms step_avg:177.85ms
step:875/3000 val_loss:3.8011 train_time:154010ms step_avg:178.05ms
step:1000/3000 val_loss:3.7559 train_time:176423ms step_avg:178.21ms
step:1125/3000 val_loss:3.7261 train_time:198525ms step_avg:178.05ms
step:1250/3000 val_loss:3.6901 train_time:220946ms step_avg:178.18ms
step:1375/3000 val_loss:3.6661 train_time:243375ms step_avg:178.30ms
step:1500/3000 val_loss:3.6383 train_time:265495ms step_avg:178.18ms
step:1625/3000 val_loss:3.6201 train_time:287952ms step_avg:178.30ms
step:1750/3000 val_loss:3.5980 train_time:310400ms step_avg:178.39ms
step:1875/3000 val_loss:3.5801 train_time:332509ms step_avg:178.29ms
step:2000/3000 val_loss:3.5643 train_time:354969ms step_avg:178.38ms
step:2125/3000 val_loss:3.5492 train_time:377415ms step_avg:178.45ms
step:2250/3000 val_loss:3.5223 train_time:399516ms step_avg:178.36ms
step:2375/3000 val_loss:3.4964 train_time:421976ms step_avg:178.43ms
step:2500/3000 val_loss:3.4715 train_time:444430ms step_avg:178.49ms
step:2625/3000 val_loss:3.4467 train_time:466546ms step_avg:178.41ms
step:2750/3000 val_loss:3.4266 train_time:488995ms step_avg:178.47ms
step:2875/3000 val_loss:3.4096 train_time:511458ms step_avg:178.52ms
step:3000/3000 val_loss:3.3999 train_time:533579ms step_avg:178.45ms
Peak memory consumption: 33433 MiB
