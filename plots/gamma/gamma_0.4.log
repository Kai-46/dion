Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.1
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 20:12:26.790000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:12:34.238000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:12:36.904000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:12:37.766000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:12:38.799000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:12:39.666000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:12:40.587000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:12:41.481000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:12:42.693000 1370 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:03<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [11:20<00:00,  4.41it/s, val_loss=3.5171]    
step:125/3000 val_loss:4.8516 train_time:20221ms step_avg:175.83ms
step:250/3000 val_loss:4.3465 train_time:42556ms step_avg:177.32ms
step:375/3000 val_loss:4.1668 train_time:64574ms step_avg:176.92ms
step:500/3000 val_loss:4.0584 train_time:86959ms step_avg:177.47ms
step:625/3000 val_loss:3.9819 train_time:109336ms step_avg:177.78ms
step:750/3000 val_loss:3.9283 train_time:131424ms step_avg:177.60ms
step:875/3000 val_loss:3.8854 train_time:153831ms step_avg:177.84ms
step:1000/3000 val_loss:3.8447 train_time:176225ms step_avg:178.01ms
step:1125/3000 val_loss:3.8186 train_time:198315ms step_avg:177.86ms
step:1250/3000 val_loss:3.7890 train_time:220697ms step_avg:177.98ms
step:1375/3000 val_loss:3.7695 train_time:243092ms step_avg:178.09ms
step:1500/3000 val_loss:3.7497 train_time:265177ms step_avg:177.97ms
step:1625/3000 val_loss:3.7346 train_time:287577ms step_avg:178.07ms
step:1750/3000 val_loss:3.7122 train_time:309987ms step_avg:178.15ms
step:1875/3000 val_loss:3.6959 train_time:332056ms step_avg:178.05ms
step:2000/3000 val_loss:3.6845 train_time:354452ms step_avg:178.12ms
step:2125/3000 val_loss:3.6680 train_time:376857ms step_avg:178.18ms
step:2250/3000 val_loss:3.6415 train_time:398943ms step_avg:178.10ms
step:2375/3000 val_loss:3.6161 train_time:421314ms step_avg:178.15ms
step:2500/3000 val_loss:3.5906 train_time:443708ms step_avg:178.20ms
step:2625/3000 val_loss:3.5662 train_time:465799ms step_avg:178.13ms
step:2750/3000 val_loss:3.5457 train_time:488207ms step_avg:178.18ms
step:2875/3000 val_loss:3.5278 train_time:510614ms step_avg:178.22ms
step:3000/3000 val_loss:3.5171 train_time:532737ms step_avg:178.17ms
Peak memory consumption: 33433 MiB
