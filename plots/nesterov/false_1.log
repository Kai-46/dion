Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.2
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 18:19:32.885000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:19:50.249000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:19:52.684000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:19:53.538000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:19:54.554000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:19:55.411000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:19:56.239000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:19:57.092000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:19:58.256000 1305 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:04<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [12:51<00:00,  3.89it/s, val_loss=3.3555]    
step:125/3000 val_loss:4.6972 train_time:23698ms step_avg:206.07ms
step:250/3000 val_loss:4.2077 train_time:49719ms step_avg:207.16ms
step:375/3000 val_loss:4.0223 train_time:75488ms step_avg:206.82ms
step:500/3000 val_loss:3.9054 train_time:101520ms step_avg:207.18ms
step:625/3000 val_loss:3.8286 train_time:127562ms step_avg:207.42ms
step:750/3000 val_loss:3.7747 train_time:153314ms step_avg:207.18ms
step:875/3000 val_loss:3.7275 train_time:179377ms step_avg:207.37ms
step:1000/3000 val_loss:3.6867 train_time:205424ms step_avg:207.50ms
step:1125/3000 val_loss:3.6570 train_time:231188ms step_avg:207.34ms
step:1250/3000 val_loss:3.6292 train_time:257216ms step_avg:207.43ms
step:1375/3000 val_loss:3.6069 train_time:283292ms step_avg:207.54ms
step:1500/3000 val_loss:3.5842 train_time:309050ms step_avg:207.42ms
step:1625/3000 val_loss:3.5676 train_time:335112ms step_avg:207.50ms
step:1750/3000 val_loss:3.5473 train_time:361172ms step_avg:207.57ms
step:1875/3000 val_loss:3.5333 train_time:386941ms step_avg:207.47ms
step:2000/3000 val_loss:3.5177 train_time:412994ms step_avg:207.53ms
step:2125/3000 val_loss:3.5039 train_time:439048ms step_avg:207.59ms
step:2250/3000 val_loss:3.4774 train_time:464793ms step_avg:207.50ms
step:2375/3000 val_loss:3.4518 train_time:490847ms step_avg:207.55ms
step:2500/3000 val_loss:3.4274 train_time:516897ms step_avg:207.59ms
step:2625/3000 val_loss:3.4033 train_time:542650ms step_avg:207.51ms
step:2750/3000 val_loss:3.3828 train_time:568701ms step_avg:207.56ms
step:2875/3000 val_loss:3.3658 train_time:594760ms step_avg:207.60ms
step:3000/3000 val_loss:3.3555 train_time:620514ms step_avg:207.53ms
Peak memory consumption: 33463 MiB
