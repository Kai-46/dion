Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.1
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 20:18:48.520000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:19:02.375000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:19:04.744000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:19:05.648000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:19:06.712000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:19:07.556000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:19:08.416000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:19:09.282000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:19:10.410000 1385 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:03<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [11:22<00:00,  4.40it/s, val_loss=3.4880]    
step:125/3000 val_loss:4.8584 train_time:20247ms step_avg:176.06ms
step:250/3000 val_loss:4.3433 train_time:43124ms step_avg:179.68ms
step:375/3000 val_loss:4.1538 train_time:65159ms step_avg:178.52ms
step:500/3000 val_loss:4.0386 train_time:87494ms step_avg:178.56ms
step:625/3000 val_loss:3.9607 train_time:109840ms step_avg:178.60ms
step:750/3000 val_loss:3.9058 train_time:131895ms step_avg:178.24ms
step:875/3000 val_loss:3.8609 train_time:154238ms step_avg:178.31ms
step:1000/3000 val_loss:3.8200 train_time:176570ms step_avg:178.35ms
step:1125/3000 val_loss:3.7918 train_time:198610ms step_avg:178.13ms
step:1250/3000 val_loss:3.7628 train_time:220982ms step_avg:178.21ms
step:1375/3000 val_loss:3.7416 train_time:243351ms step_avg:178.28ms
step:1500/3000 val_loss:3.7179 train_time:265418ms step_avg:178.13ms
step:1625/3000 val_loss:3.7031 train_time:287767ms step_avg:178.18ms
step:1750/3000 val_loss:3.6850 train_time:310112ms step_avg:178.23ms
step:1875/3000 val_loss:3.6679 train_time:332174ms step_avg:178.11ms
step:2000/3000 val_loss:3.6558 train_time:354544ms step_avg:178.16ms
step:2125/3000 val_loss:3.6402 train_time:376888ms step_avg:178.20ms
step:2250/3000 val_loss:3.6121 train_time:398953ms step_avg:178.10ms
step:2375/3000 val_loss:3.5875 train_time:421309ms step_avg:178.14ms
step:2500/3000 val_loss:3.5623 train_time:443688ms step_avg:178.19ms
step:2625/3000 val_loss:3.5374 train_time:465740ms step_avg:178.10ms
step:2750/3000 val_loss:3.5165 train_time:488104ms step_avg:178.14ms
step:2875/3000 val_loss:3.4988 train_time:510476ms step_avg:178.18ms
step:3000/3000 val_loss:3.4880 train_time:532543ms step_avg:178.11ms
Peak memory consumption: 33433 MiB
