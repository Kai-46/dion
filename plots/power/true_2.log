Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.2
  - Newton-Schulz iterations: -1
  - Power iterations: 2
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 18:12:55.900000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:13:08.367000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:13:10.804000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:13:11.711000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:13:12.827000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:13:13.743000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:13:14.643000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:13:15.477000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 18:13:16.642000 1365 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:03<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [15:46<00:00,  3.17it/s, val_loss=3.3535]    
step:125/3000 val_loss:4.7351 train_time:30629ms step_avg:266.34ms
step:250/3000 val_loss:4.2137 train_time:64165ms step_avg:267.35ms
step:375/3000 val_loss:4.0247 train_time:97460ms step_avg:267.01ms
step:500/3000 val_loss:3.9077 train_time:130963ms step_avg:267.27ms
step:625/3000 val_loss:3.8319 train_time:164490ms step_avg:267.46ms
step:750/3000 val_loss:3.7726 train_time:197793ms step_avg:267.29ms
step:875/3000 val_loss:3.7258 train_time:231364ms step_avg:267.47ms
step:1000/3000 val_loss:3.6853 train_time:264899ms step_avg:267.58ms
step:1125/3000 val_loss:3.6555 train_time:298185ms step_avg:267.43ms
step:1250/3000 val_loss:3.6261 train_time:331736ms step_avg:267.53ms
step:1375/3000 val_loss:3.6064 train_time:365291ms step_avg:267.61ms
step:1500/3000 val_loss:3.5803 train_time:398573ms step_avg:267.50ms
step:1625/3000 val_loss:3.5640 train_time:432077ms step_avg:267.54ms
step:1750/3000 val_loss:3.5434 train_time:465591ms step_avg:267.58ms
step:1875/3000 val_loss:3.5281 train_time:498879ms step_avg:267.50ms
step:2000/3000 val_loss:3.5126 train_time:532376ms step_avg:267.53ms
step:2125/3000 val_loss:3.5011 train_time:565871ms step_avg:267.55ms
step:2250/3000 val_loss:3.4744 train_time:599149ms step_avg:267.48ms
step:2375/3000 val_loss:3.4497 train_time:632647ms step_avg:267.50ms
step:2500/3000 val_loss:3.4249 train_time:666168ms step_avg:267.54ms
step:2625/3000 val_loss:3.4011 train_time:699454ms step_avg:267.48ms
step:2750/3000 val_loss:3.3806 train_time:732976ms step_avg:267.51ms
step:2875/3000 val_loss:3.3635 train_time:766534ms step_avg:267.55ms
step:3000/3000 val_loss:3.3535 train_time:799839ms step_avg:267.50ms
Peak memory consumption: 33457 MiB
