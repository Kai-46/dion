Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.6
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 19:44:17.512000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:44:34.222000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:44:36.623000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:44:37.480000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:44:38.455000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:44:39.301000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:44:40.137000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:44:40.931000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:44:42.067000 1410 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:03<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [19:00<00:00,  2.63it/s, val_loss=3.3023]    
step:125/3000 val_loss:4.6837 train_time:37963ms step_avg:330.11ms
step:250/3000 val_loss:4.1160 train_time:79528ms step_avg:331.37ms
step:375/3000 val_loss:3.9299 train_time:120762ms step_avg:330.85ms
step:500/3000 val_loss:3.8227 train_time:162326ms step_avg:331.28ms
step:625/3000 val_loss:3.7489 train_time:203874ms step_avg:331.50ms
step:750/3000 val_loss:3.6968 train_time:245107ms step_avg:331.23ms
step:875/3000 val_loss:3.6533 train_time:286664ms step_avg:331.40ms
step:1000/3000 val_loss:3.6181 train_time:328131ms step_avg:331.45ms
step:1125/3000 val_loss:3.5910 train_time:369346ms step_avg:331.25ms
step:1250/3000 val_loss:3.5640 train_time:410885ms step_avg:331.36ms
step:1375/3000 val_loss:3.5442 train_time:452431ms step_avg:331.45ms
step:1500/3000 val_loss:3.5231 train_time:493666ms step_avg:331.32ms
step:1625/3000 val_loss:3.5080 train_time:535202ms step_avg:331.39ms
step:1750/3000 val_loss:3.4905 train_time:576718ms step_avg:331.45ms
step:1875/3000 val_loss:3.4759 train_time:617949ms step_avg:331.34ms
step:2000/3000 val_loss:3.4630 train_time:659483ms step_avg:331.40ms
step:2125/3000 val_loss:3.4511 train_time:701023ms step_avg:331.45ms
step:2250/3000 val_loss:3.4249 train_time:742246ms step_avg:331.36ms
step:2375/3000 val_loss:3.4005 train_time:783773ms step_avg:331.41ms
step:2500/3000 val_loss:3.3755 train_time:825330ms step_avg:331.46ms
step:2625/3000 val_loss:3.3515 train_time:866566ms step_avg:331.38ms
step:2750/3000 val_loss:3.3306 train_time:908110ms step_avg:331.43ms
step:2875/3000 val_loss:3.3130 train_time:949690ms step_avg:331.48ms
step:3000/3000 val_loss:3.3023 train_time:990925ms step_avg:331.41ms
Peak memory consumption: 33580 MiB
