Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon2 optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.5
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0312 14:10:59.303000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program
[rank0]:W0312 14:11:07.221000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program
[rank0]:W0312 14:11:09.421000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program
[rank0]:W0312 14:11:10.232000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program
[rank0]:W0312 14:11:11.246000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program
[rank0]:W0312 14:11:12.099000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program
[rank0]:W0312 14:11:12.926000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program
[rank0]:W0312 14:11:13.739000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program
[rank0]:W0312 14:11:14.532000 1339 site-packages/torch/_inductor/utils.py:1762] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [00:49<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:236: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [16:46<00:00,  2.98it/s, val_loss=3.5201]   
step:125/3000 val_loss:4.9679 train_time:33787ms step_avg:293.80ms
step:250/3000 val_loss:4.4468 train_time:70823ms step_avg:295.10ms
step:375/3000 val_loss:4.2699 train_time:107582ms step_avg:294.74ms
step:500/3000 val_loss:4.1463 train_time:144648ms step_avg:295.20ms
step:625/3000 val_loss:4.0643 train_time:181650ms step_avg:295.37ms
step:750/3000 val_loss:4.0087 train_time:218405ms step_avg:295.14ms
step:875/3000 val_loss:3.9518 train_time:255448ms step_avg:295.32ms
step:1000/3000 val_loss:3.9065 train_time:292515ms step_avg:295.47ms
step:1125/3000 val_loss:3.8751 train_time:329261ms step_avg:295.30ms
step:1250/3000 val_loss:3.8463 train_time:366301ms step_avg:295.40ms
step:1375/3000 val_loss:3.8192 train_time:403362ms step_avg:295.50ms
step:1500/3000 val_loss:3.7949 train_time:440110ms step_avg:295.38ms
step:1625/3000 val_loss:3.7776 train_time:477176ms step_avg:295.46ms
step:1750/3000 val_loss:3.7569 train_time:514259ms step_avg:295.55ms
step:1875/3000 val_loss:3.7328 train_time:551018ms step_avg:295.45ms
step:2000/3000 val_loss:3.7177 train_time:588072ms step_avg:295.51ms
step:2125/3000 val_loss:3.7026 train_time:625129ms step_avg:295.57ms
step:2250/3000 val_loss:3.6681 train_time:661889ms step_avg:295.49ms
step:2375/3000 val_loss:3.6365 train_time:698935ms step_avg:295.53ms
step:2500/3000 val_loss:3.5987 train_time:735971ms step_avg:295.57ms
step:2625/3000 val_loss:3.5704 train_time:772723ms step_avg:295.50ms
step:2750/3000 val_loss:3.5466 train_time:809745ms step_avg:295.53ms
step:2875/3000 val_loss:3.5289 train_time:846794ms step_avg:295.57ms
step:3000/3000 val_loss:3.5201 train_time:883538ms step_avg:295.50ms
Peak memory consumption: 33530 MiB
