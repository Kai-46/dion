Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.1
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 19:52:25.043000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:52:36.346000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:52:38.853000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:52:39.736000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:52:40.741000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:52:41.597000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:52:42.448000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:52:43.282000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:52:44.468000 1393 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:4ms step_avg:nanms
Training:   0%|          | 0/3000 [01:05<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [11:23<00:00,  4.39it/s, val_loss=3.5489]    
step:125/3000 val_loss:4.8756 train_time:20248ms step_avg:176.07ms
step:250/3000 val_loss:4.3642 train_time:42616ms step_avg:177.57ms
step:375/3000 val_loss:4.1865 train_time:64665ms step_avg:177.16ms
step:500/3000 val_loss:4.0775 train_time:87050ms step_avg:177.65ms
step:625/3000 val_loss:4.0026 train_time:109465ms step_avg:177.99ms
step:750/3000 val_loss:3.9510 train_time:131537ms step_avg:177.75ms
step:875/3000 val_loss:3.9085 train_time:153968ms step_avg:178.00ms
step:1000/3000 val_loss:3.8701 train_time:176407ms step_avg:178.19ms
step:1125/3000 val_loss:3.8439 train_time:198483ms step_avg:178.01ms
step:1250/3000 val_loss:3.8161 train_time:220961ms step_avg:178.19ms
step:1375/3000 val_loss:3.7987 train_time:243398ms step_avg:178.31ms
step:1500/3000 val_loss:3.7744 train_time:265503ms step_avg:178.19ms
step:1625/3000 val_loss:3.7606 train_time:287912ms step_avg:178.27ms
step:1750/3000 val_loss:3.7419 train_time:310332ms step_avg:178.35ms
step:1875/3000 val_loss:3.7258 train_time:332426ms step_avg:178.24ms
step:2000/3000 val_loss:3.7139 train_time:354800ms step_avg:178.29ms
step:2125/3000 val_loss:3.6989 train_time:377241ms step_avg:178.36ms
step:2250/3000 val_loss:3.6722 train_time:399327ms step_avg:178.27ms
step:2375/3000 val_loss:3.6480 train_time:421764ms step_avg:178.34ms
step:2500/3000 val_loss:3.6228 train_time:444202ms step_avg:178.39ms
step:2625/3000 val_loss:3.5981 train_time:466283ms step_avg:178.31ms
step:2750/3000 val_loss:3.5774 train_time:488720ms step_avg:178.36ms
step:2875/3000 val_loss:3.5597 train_time:511169ms step_avg:178.42ms
step:3000/3000 val_loss:3.5489 train_time:533249ms step_avg:178.34ms
Peak memory consumption: 33433 MiB
