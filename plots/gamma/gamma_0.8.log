Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.1
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 20:19:47.599000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:20:01.212000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:20:03.763000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:20:04.668000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:20:05.672000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:20:06.513000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:20:07.381000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:20:08.201000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 20:20:09.336000 1340 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:3ms step_avg:nanms
Training:   0%|          | 0/3000 [01:03<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [11:20<00:00,  4.41it/s, val_loss=3.4569]    
step:125/3000 val_loss:4.8312 train_time:20201ms step_avg:175.66ms
step:250/3000 val_loss:4.3284 train_time:42480ms step_avg:177.00ms
step:375/3000 val_loss:4.1372 train_time:64468ms step_avg:176.63ms
step:500/3000 val_loss:4.0190 train_time:86760ms step_avg:177.06ms
step:625/3000 val_loss:3.9397 train_time:109074ms step_avg:177.36ms
step:750/3000 val_loss:3.8850 train_time:131099ms step_avg:177.16ms
step:875/3000 val_loss:3.8368 train_time:153444ms step_avg:177.39ms
step:1000/3000 val_loss:3.7953 train_time:175789ms step_avg:177.56ms
step:1125/3000 val_loss:3.7670 train_time:197818ms step_avg:177.42ms
step:1250/3000 val_loss:3.7378 train_time:220175ms step_avg:177.56ms
step:1375/3000 val_loss:3.7163 train_time:242516ms step_avg:177.67ms
step:1500/3000 val_loss:3.6934 train_time:264547ms step_avg:177.55ms
step:1625/3000 val_loss:3.6741 train_time:286869ms step_avg:177.63ms
step:1750/3000 val_loss:3.6543 train_time:309220ms step_avg:177.71ms
step:1875/3000 val_loss:3.6394 train_time:331243ms step_avg:177.61ms
step:2000/3000 val_loss:3.6237 train_time:353554ms step_avg:177.67ms
step:2125/3000 val_loss:3.6093 train_time:375892ms step_avg:177.73ms
step:2250/3000 val_loss:3.5807 train_time:397947ms step_avg:177.65ms
step:2375/3000 val_loss:3.5566 train_time:420286ms step_avg:177.71ms
step:2500/3000 val_loss:3.5296 train_time:442618ms step_avg:177.76ms
step:2625/3000 val_loss:3.5054 train_time:464639ms step_avg:177.68ms
step:2750/3000 val_loss:3.4851 train_time:486992ms step_avg:177.73ms
step:2875/3000 val_loss:3.4673 train_time:509325ms step_avg:177.77ms
step:3000/3000 val_loss:3.4569 train_time:531353ms step_avg:177.71ms
Peak memory consumption: 33433 MiB
