Training DataLoader: total tokens: 10255324043 in 103 files
Validation DataLoader: total tokens: 100000000 in 1 files
DeMon optimizer initialized with:
  - Learning rate: 0.04
  - Momentum factor (mu): 0.95
  - Residual factor (beta): 0.95
  - Weight decay: 0
  - Sparsity: 0.4
  - Newton-Schulz iterations: -1
  - Power iterations: 1
  - Epsilon: 1e-07
  - Tuned Newton-Schulz constants: False
  - Rank-r approximation method: power_iter
Training:   0%|          | 0/3000 [00:00<?, ?it/s][rank0]:W0310 19:21:20.465000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:21:29.618000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:21:32.153000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:21:33.079000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:21:34.127000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:21:35.100000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:21:36.067000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:21:37.015000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program
[rank0]:W0310 19:21:38.275000 1356 site-packages/torch/_inductor/utils.py:1614] [0/0] DeviceCopy in input program

step:0/3000 val_loss:10.8258 train_time:4ms step_avg:nanms
Training:   0%|          | 0/3000 [01:02<?, ?it/s, val_loss=10.8258]/opt/conda/envs/ptca/lib/python3.10/site-packages/torch/_inductor/compile_fx.py:200: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
Training: 100%|██████████| 3000/3000 [15:50<00:00,  3.16it/s, val_loss=3.3149]    
step:125/3000 val_loss:4.6165 train_time:30770ms step_avg:267.57ms
step:250/3000 val_loss:4.1201 train_time:64499ms step_avg:268.75ms
step:375/3000 val_loss:3.9476 train_time:97936ms step_avg:268.32ms
step:500/3000 val_loss:3.8345 train_time:131665ms step_avg:268.70ms
step:625/3000 val_loss:3.7616 train_time:165378ms step_avg:268.91ms
step:750/3000 val_loss:3.7109 train_time:198819ms step_avg:268.67ms
step:875/3000 val_loss:3.6676 train_time:232507ms step_avg:268.79ms
step:1000/3000 val_loss:3.6308 train_time:266187ms step_avg:268.88ms
step:1125/3000 val_loss:3.6034 train_time:299621ms step_avg:268.72ms
step:1250/3000 val_loss:3.5769 train_time:333290ms step_avg:268.78ms
step:1375/3000 val_loss:3.5579 train_time:366975ms step_avg:268.85ms
step:1500/3000 val_loss:3.5428 train_time:400407ms step_avg:268.73ms
step:1625/3000 val_loss:3.5249 train_time:434082ms step_avg:268.78ms
step:1750/3000 val_loss:3.5045 train_time:467760ms step_avg:268.83ms
step:1875/3000 val_loss:3.4896 train_time:501180ms step_avg:268.73ms
step:2000/3000 val_loss:3.4767 train_time:534876ms step_avg:268.78ms
step:2125/3000 val_loss:3.4639 train_time:568572ms step_avg:268.83ms
step:2250/3000 val_loss:3.4379 train_time:602013ms step_avg:268.76ms
step:2375/3000 val_loss:3.4127 train_time:635689ms step_avg:268.79ms
step:2500/3000 val_loss:3.3877 train_time:669410ms step_avg:268.84ms
step:2625/3000 val_loss:3.3639 train_time:702841ms step_avg:268.77ms
step:2750/3000 val_loss:3.3429 train_time:736543ms step_avg:268.81ms
step:2875/3000 val_loss:3.3255 train_time:770245ms step_avg:268.85ms
step:3000/3000 val_loss:3.3149 train_time:803705ms step_avg:268.80ms
Peak memory consumption: 33519 MiB
